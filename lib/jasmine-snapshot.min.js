!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("difflib"),require("vkbeautify"),require("x2js")):"function"==typeof define&&define.amd?define("jasmine-snapshot",["difflib","vkbeautify","x2js"],e):"object"==typeof exports?exports["jasmine-snapshot"]=e(require("difflib"),require("vkbeautify"),require("x2js")):t["jasmine-snapshot"]=e(t.difflib,t.vkbeautify,t.x2js)}(this,function(t,e,n){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=11)}([function(t,e,n){"use strict";function r(t,e,n){return t.substr(n||0,e.length)===e}function o(t,e,n){var r=(n||t.length)-e.length,o=t.lastIndexOf(e,r);return-1!==o&&o===r}function i(t,e,n){return-1!==t.indexOf(e,n||0)}function s(t){return"number"==typeof t&&isNaN(t)}function a(t,e,n){var r=t.length;if(0===r)return!1;for(var o=0|n,i=s(e),a=o>=0?o:r+o;a<r;){var u=t[a++];if(u===e)return!0;if(i&&s(u))return!0}return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.startsWith=r,e.endsWith=o,e.stringIncludes=i,e.isRealNaN=s,e.arrayIncludes=a},function(t,e){var n=console.warn;console.warn=function(){arguments.length>0&&"string"==typeof arguments[0]&&-1!==arguments[0].indexOf("[xmldom ")||n.apply(console,arguments)};var r=console.error;console.error=function(){arguments.length>0&&"string"==typeof arguments[0]&&-1!==arguments[0].indexOf("entity not found")||r.apply(console,arguments)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(12);e.himalaya=r.parse;var o=n(13);e.x2js=o.parse,e.default=function(t){switch(t){case"himalaya":return r.parse;default:return o.parse}}},function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e,n){"use strict";function r(t,e){var n=t.indexOf(e);return-1===n?[t]:[t.slice(0,n),t.slice(n+e.length)]}function o(t){var e=t.charAt(0),n=t.length-1;return'"'!==e&&"'"!==e||e!==t.charAt(n)?t:t.slice(1,n)}function i(t,e){return t.map(function(t){var n=t.type,r="element"===n?{type:n,tagName:t.tagName.toLowerCase(),attributes:s(t.attributes),children:i(t.children,e)}:{type:n,content:t.content};return e.includePositions&&(r.position=t.position),r})}function s(t){return t.map(function(t){var e=r(t.trim(),"=");return{key:e[0],value:"string"==typeof e[1]?o(e[1]):null}})}Object.defineProperty(e,"__esModule",{value:!0}),e.splitHead=r,e.unquote=o,e.format=i,e.formatAttributes=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,n=(0,a.default)(t,e),r=(0,c.default)(n,e);return(0,l.format)(r,e)}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;return(0,p.toHTML)(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.parseDefaults=void 0,e.parse=o,e.stringify=i;var s=n(7),a=r(s),u=n(8),c=r(u),l=n(5),p=n(9),f=n(10),h=e.parseDefaults={voidTags:f.voidTags,closingTags:f.closingTags,childlessTags:f.childlessTags,closingTagAncestorBreakers:f.closingTagAncestorBreakers,includePositions:!1}},function(t,e,n){"use strict";function r(t,e,n){for(var r=t.index,o=t.index=r+n,i=r;i<o;i++){"\n"===e.charAt(i)?(t.line++,t.column=0):t.column++}}function o(t,e,n){return r(t,e,n-t.index)}function i(){return{index:0,column:0,line:0}}function s(t){return{index:t.index,line:t.line,column:t.column}}function a(t,e){var n={str:t,options:e,position:i(),tokens:[]};return u(n),n.tokens}function u(t){for(var e=t.str,n=t.options.childlessTags,r=e.length;t.position.index<r;){var o=t.position.index;if(l(t),t.position.index===o){if((0,y.startsWith)(e,"!--",o+1))p(t);else{var i=f(t),s=i.toLowerCase();(0,y.arrayIncludes)(n,s)&&g(i,t)}}}}function c(t,e){for(;;){var n=t.indexOf("<",e);if(-1===n)return n;var r=t.charAt(n+1);if("/"===r||"!"===r||m.test(r))return n;e=n+1}}function l(t){var e=t.str,n=t.position,r=c(e,n.index);if(r!==n.index){-1===r&&(r=e.length);var i=s(n),a=e.slice(n.index,r);o(n,e,r);var u=s(n);t.tokens.push({type:"text",content:a,position:{start:i,end:u}})}}function p(t){var e=t.str,n=t.position,i=s(n);r(n,e,4);var a=e.indexOf("--\x3e",n.index),u=a+3;-1===a&&(a=u=e.length);var c=e.slice(n.index,a);o(n,e,u),t.tokens.push({type:"comment",content:c,position:{start:i,end:s(n)}})}function f(t){var e=t.str,n=t.position,o=e.charAt(n.index+1),i="/"===o,a=s(n);r(n,e,i?2:1),t.tokens.push({type:"tag-start",close:i,position:{start:a}});var u=d(t);v(t);var c=e.charAt(n.index),l="/"===c;r(n,e,l?2:1);var p=s(n);return t.tokens.push({type:"tag-end",close:l,position:{end:p}}),u}function h(t){return b.test(t)}function d(t){for(var e=t.str,n=t.position,r=e.length,i=n.index;i<r;){var s=e.charAt(i);if(!(h(s)||"/"===s||">"===s))break;i++}for(var a=i+1;a<r;){var u=e.charAt(a);if(!!(h(u)||"/"===u||">"===u))break;a++}o(n,e,a);var c=e.slice(i,a);return t.tokens.push({type:"tag",content:c}),c}function v(t){for(var e=t.str,n=t.position,r=t.tokens,i=n.index,s=null,a=i,u=[],c=e.length;i<c;){var l=e.charAt(i);if(s){l===s&&(s=null),i++}else{if("/"===l||">"===l){i!==a&&u.push(e.slice(a,i));break}if(h(l))i!==a&&u.push(e.slice(a,i)),a=i+1,i++;else{"'"===l||'"'===l?(s=l,i++):i++}}}o(n,e,i);for(var p=u.length,f="attribute",d=0;d<p;d++){var v=u[d];if(-1===v.indexOf("=")){var g=u[d+1];if(g&&(0,y.startsWith)(g,"=")){if(g.length>1){var m=v+g;r.push({type:f,content:m}),d+=1;continue}var b=u[d+2];if(d+=1,b){var x=v+"="+b;r.push({type:f,content:x}),d+=1;continue}}}if((0,y.endsWith)(v,"=")){var _=u[d+1];if(_&&!(0,y.stringIncludes)(_,"=")){var k=v+_;r.push({type:f,content:k}),d+=1;continue}var O=v.slice(0,-1);r.push({type:f,content:O})}else r.push({type:f,content:v})}}function g(t,e){for(var n=e.str,r=e.position,i=e.tokens,a=t.toLowerCase(),u=n.length,c=r.index;c<u;){var p=n.indexOf("</",c);if(-1===p){l(e);break}var h=s(r);o(h,n,p);var d={str:n,position:h,tokens:[]};if(a===f(d).toLowerCase()){if(p!==r.index){var v=s(r);o(r,n,p),i.push({type:"text",content:n.slice(v.index,p),position:{start:v,end:s(r)}})}x.apply(i,d.tokens),o(r,n,d.position.index);break}c=d.position.index}}Object.defineProperty(e,"__esModule",{value:!0}),e.feedPosition=r,e.jumpPosition=o,e.makeInitialPosition=i,e.copyPosition=s,e.default=a,e.lex=u,e.findTextEnd=c,e.lexText=l,e.lexComment=p,e.lexTag=f,e.isWhitespaceChar=h,e.lexTagName=d,e.lexTagAttributes=v,e.lexSkipTag=g;var y=n(0),m=/[A-Za-z0-9]/,b=/\s/,x=[].push},function(t,e,n){"use strict";function r(t,e){var n={tagName:null,children:[]};return s({tokens:t,options:e,cursor:0,stack:[n]}),n.children}function o(t,e,n){var r=n[t];if(r)for(var o=e.length-1;o>=0;){var i=e[o].tagName;if(i===t)break;if((0,a.arrayIncludes)(r,i))return!0;o--}return!1}function i(t,e,n,r){t[e].position.end=r;for(var o=e+1,i=t.length;o<i;o++)t[o].position.end=n;t.splice(e)}function s(t){for(var e=t.tokens,n=t.options,r=t.stack,u=r[r.length-1].children,c=e.length,l=t.cursor;l<c;){var p=e[l];if("tag-start"===p.type){var f=e[++l];l++;var h=f.content.toLowerCase();if(p.close){for(var d=r.length,v=!1;--d>-1;)if(r[d].tagName===h){v=!0;break}for(;l<c;){if("tag-end"!==e[l].type)break;l++}if(v){i(r,d,p.position.start,e[l-1].position.end);break}}else{var g=(0,a.arrayIncludes)(n.closingTags,h),y=g;if(y){y=!o(h,r,n.closingTagAncestorBreakers)}if(y)for(var m=r.length-1;m>0;){if(h===r[m].tagName){i(r,m,p.position.start,p.position.start);var b=m-1;u=r[b].children;break}m-=1}for(var x=[],_=void 0;l<c&&(_=e[l],"tag-end"!==_.type);)x.push(_.content),l++;l++;var k=[],O={start:p.position.start,end:_.position.end},j={type:"element",tagName:f.content,attributes:x,children:k,position:O};u.push(j);if(!(_.close||(0,a.arrayIncludes)(n.voidTags,h))){var w=r.push({tagName:h,children:k,position:O}),A={tokens:e,options:n,cursor:l,stack:r};s(A),l=A.cursor;r.length===w&&(j.position.end=e[l-1].position.end)}}}else u.push(p),l++}t.cursor=l}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r,e.hasTerminalParent=o,e.rewindStack=i,e.parse=s;var a=n(0)},function(t,e,n){"use strict";function r(t){return t.reduce(function(t,e){var n=e.key,r=e.value;if(null===r)return t+" "+n;var o=-1!==r.indexOf("'"),i=o?'"':"'";return t+" "+n+"="+i+r+i},"")}function o(t,e){return t.map(function(t){if("text"===t.type)return t.content;if("comment"===t.type)return"\x3c!--"+t.content+"--\x3e";var n=t.tagName,s=t.attributes,a=t.children;return(0,i.arrayIncludes)(e.voidTags,n.toLowerCase())?"<"+n+r(s)+">":"<"+n+r(s)+">"+o(a,e)+"</"+n+">"}).join("")}Object.defineProperty(e,"__esModule",{value:!0}),e.formatAttributes=r,e.toHTML=o;var i=n(0);e.default={toHTML:o}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.childlessTags=["style","script","template"],e.closingTags=["html","head","body","p","dt","dd","li","option","thead","th","tbody","tr","td","tfoot","colgroup"],e.closingTagAncestorBreakers={li:["ul","ol","menu"],dt:["dl"],dd:["dl"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table"],td:["table"]},e.voidTags=["!doctype","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]},function(t,e,n){"use strict";function r(t,e){g=t,y=new x(k,e)}function o(){e.KeyExceptionList=["typeof"]}function i(t,e,n){if(e!==t){var r=h.unifiedDiff(t.split("\n"),e.split("\n"));if(n){if(!y)throw"autoagic snapshot with no registered snapshot object";y.reportFailure(r)}var o="\n";if(o+="**** "+_+" diff *****\n\n",r.forEach(function(t){"--- \n"===t||"+++ \n"===t||t.length>5&&"@@"===t.slice(0,2)||(o+=t+"\n")}),o+="\n",!n){var i=s(e);o+="**** If the Actual is valid, update the snapshot with this ****\n",o+=" ----- Formatted ------\n"+e+"\n\n ----- Single Line ------\n"+i}console.error(o),fail("Actual does not match snapshot. See above. ")}}function s(t){for(var e=t.replace(/\n/g,"").replace(/\t/g,"").replace(/\\"/g,'\\\\\\"');-1!==e.indexOf("  ");)e=e.replace(/(  )/g," ");return e}function a(t,e){p(e).toMatchSnapshot(t)}function u(t,e){var n=e?d.json(e):e;i(t?d.json(t):t,n)}function c(t,e){l(e).toMatchSnapshot(t)}function l(t){return new j(t)}function p(t,e,n){return new w(t,e,n)}var f=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var h=n(3),d=n(4),v=n(2);n(1);var g={};e.registerSnapshots=r;var y,m=function(){function t(){}return t}(),b=new Array,x=function(){function t(t,e){this.snapshots=Array(),this.level=0,this.fail_counter_for_autosnapshot=0,this.last_automagic_snapshot_spec="",this.last_automagic_snapshot_number=0,this.level=t,this.name=e}return t.prototype.getSnapshotAutomagically_saveActual=function(t){var e=new m;_===this.last_automagic_snapshot_spec?this.last_automagic_snapshot_number++:(this.last_automagic_snapshot_number=1,this.last_automagic_snapshot_spec=_),e.key=s(_+" "+this.last_automagic_snapshot_number),e.text=s(t),this.snapshots.push(e);var n=g[e.key];return n||""},t.prototype.hasFailure=function(){return this.fail_counter_for_autosnapshot>0},t.prototype.reportFailure=function(t){this.snapshots[this.snapshots.length-1].diff=t,this.fail_counter_for_autosnapshot++},t.prototype.getText=function(){for(var t="\n**** If actual is valid, update your snapshot with the following ****\n{",e=!1,n=0,r=this.snapshots;n<r.length;n++){var o=r[n];e=!0,t+='\n\t"'+o.key+'": `'+o.text+"`,"}return e&&(t=t.slice(0,t.length-1),t+="\n}\n\n"),t},t.prototype.pushToHistory=function(){b.push(this)},t.prototype.getHTML=function(){if("undefined"!=typeof document&&(document.body.style.fontFamily="Courier New",document.body.style.whiteSpace="nowrap"),!this.name)throw"name not defined for snapshot suite";if(!this.hasFailure())return'<p style="color: green; font-size: 25px; font-weight: bold;">===Auto snapshot suite, '+this.name+", has no problems!===</p>";var t='<p style="color: red; font-size: 25px; font-weight: bold;">===Suite, '+this.name+", had problems===</p>";this.snapshots.forEach(function(e){e.diff&&(t+='<div>>Test: "'+e.key+'" did not match the snapshot:</div><br //>',e.diff.forEach(function(e){e.length>=3&&("---"===e.slice(0,3)||"+++"===e.slice(0,3))||"@@"===e.slice(0,2)||("-"===e.charAt(0)?t+='<span style="color: red">'+e.replace(/&nbsp;/g,"&amp;nbsp;").replace(/ /g,"&nbsp;")+"</span><br //>":"+"===e.charAt(0)?t+='<span style="color: green">'+e.replace(/&nbsp;/g,"&amp;nbsp;").replace(/ /g,"&nbsp;")+"</span><br //>":t+=e.replace(/&nbsp;/g,"&amp;nbsp;").replace(/ /g,"&nbsp;")+"<br //>")}))}),t+='<p style="text-decoration: underline; font-weight: bold;">If actual is valid, update your snapshot with the following <//p>',t+="<div style='color: blue;'>{";for(var e=!1,n=0,r=this.snapshots;n<r.length;n++){var o=r[n];e=!0,t+='<br //>&nbsp;&nbsp;&nbsp;&nbsp;"'+o.key+'": `'+o.text.replace(/&nbsp;/g,"&amp;nbsp;")+"`,"}return e&&(t=t.slice(0,t.length-1),t+="<br //>}</div></p>"),t},t}(),_="",k=0;jasmine.getEnv().addReporter({suiteStarted:function(t){k++},specStarted:function(t){_=t.fullName},suiteDone:function(t){k--,y&&k<y.level&&(y.hasFailure,y.pushToHistory(),y=null)},jasmineDone:function(t){if(y&&(y.hasFailure,y.pushToHistory(),y=null),0!==b.length){var e=b.reduce(function(t,e){return t+"<br //>"+e.getHTML()},"");"undefined"!=typeof document?document.body.innerHTML=e+document.body.innerHTML:console.log(e)}}}),e.KeyExceptionList=["typeof"],e.ResetExceptionList=o,e.MatchesSnapshot=i,e.MatchesXMLSnapshot=a,e.MatchesJSONSnapshot=u,e.MatchesJSSnapshot=c,e.expectjs=l,e.expectxml=p;var O=function(){function t(t){this.actual=t}return t.prototype.afterApplying=function(t){return this.actual=t(this.actual),this},t}(),j=function(t){function n(e){var n=t.call(this,e)||this;return n.parsed_values=new Array,n.actual=e,n}return f(n,t),n.prototype.toMatchSnapshot=function(t){var e=this.actual?d.json(this.getOrderedStringifyAndClean()):"",n=t,r=!1;if(null===t||void 0===t){if(!y)throw"Use of autosnapshot without registering snapshot object";r=!0;var o=y.getSnapshotAutomagically_saveActual(e);n=o?d.json(o):""}else n=t?d.json(t):t;i(n,e,r)},n.prototype.getOrderedStringifyAndClean=function(){var t=this.collectAllKeysAndRemoveCircular(this.actual);return JSON.stringify(this.actual,t)},n.prototype.collectAllKeysAndRemoveCircular=function(t){var e=this,n=new Array,r=JSON.stringify(t,function(t,r){if(!e.isIEPooOrCurcularReferences(t,r))return n.push(t),r});return this.actual=JSON.parse(r),n.sort(function(t,e){return t>e?1:-1})},n.prototype.isIEPooOrCurcularReferences=function(t,n){return!("string"!=typeof t||!e.KeyExceptionList.some(function(e){return-1!==t.indexOf(e)}))||!!this.IsCurcularDependency(n)},n.prototype.IsCurcularDependency=function(t){return!(!t||"object"!=typeof t)&&(-1!==this.parsed_values.indexOf(t)||(this.parsed_values.push(t),!1))},n}(O);e.SnapshotJSInner=j;var w=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.parser=v.default(n),o.parserOptions=r,o.actual=e,o}return f(e,t),e.prototype.toMatchSnapshot=function(t){l(this.parser(this.actual,this.parserOptions)).toMatchSnapshot(t)},e}(O);e.SnapshotXMLInner=w},function(t,e,n){"use strict";function r(t){return t.filter(function(t){return"element"===t.type?(t.children=r(t.children),!0):t.content.length})}function o(t){return t.map(function(t){return"element"===t.type?t.children=o(t.children):t.content=t.content.trim(),t})}function i(t){return r(o(t))}Object.defineProperty(e,"__esModule",{value:!0});var s=n(6);e.parse=function(t,e){var n=s.parse(t);return!1!==(e||{}).preservesWhitespace&&(n=i(n)),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(14);e.parse=function(t){return(new r).xml2js(t)}},function(t,e){t.exports=n}])});
//# sourceMappingURL=jasmine-snapshot.min.js.map